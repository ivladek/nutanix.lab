{
    "name": "ns1",
    "timezone": "Asia/Almaty",
    "boot": {
        "uefi_boot": true
    },
    "memory_mb": 1024,
    "num_vcpus": 1,
    "num_cores_per_vcpu": 1,
    "vm_disks": [
        {
            "is_cdrom": true,
            "is_empty": true,
            "disk_address": {
                "device_bus": "IDE",
                "device_index": 0
            }
        },
        {
            "is_cdrom": false,
            "disk_address": {
                "device_bus": "SCSI",
                "device_index": 0
            },
            "vm_disk_clone": {
                "disk_address": {
                    "vmdisk_uuid": "7befd4c8-0d45-4351-ac5e-f587a85d6c37"
                },
                "minimum_size": 5368709120
            }
        }
    ],
    "vm_nics": [
        {
            "network_uuid": "3d1c04de-6345-4a69-aa9b-cdd34cf3722c",
            "is_connected": true,
            "request_ip": true,
            "requested_ip_address": "10.1.8.11"
        }
    ],
    "vm_customization_config": {
        "userdata": "#cloud-config\n\nfqdn: ns1.nutanix.lab\nmanage_etc_hosts: true\ntimezone: Asia\/Almaty\n\nusers:\n  - name: nutanix\n    hashed_passwd: $6$rounds=4096$PcS8PVotAkBo0Kwj$o6bingcJqa.wdp5YQc.8k0ngeTmQX\/VKJrCBCfqI7ULG18Y29JcZUM8vPrga\/omeUsyuQ.eEU3wBOAhyMIE351\n    groups: sudo\n    shell: \/bin\/bash\n    sudo: ALL=(ALL) NOPASSWD:ALL\n    lock_passwd: false\n\nssh_pwauth: true\nchpasswd:\n  expire: false\n\nwrite_files:\n  - path: \/etc\/bind\/named.conf.options\n    owner: root:bind\n    permissions: \"0644\"\n    encoding: text\/plain\n    content: |\n      options {\n        directory           \"\/var\/cache\/bind\";\n        listen-on           { any; };\n        listen-on-v6        { none; };\n        dnssec-validation   auto;\n\n        allow-query-cache   { any; };\n        recursion           yes;\n        allow-query         { any; };\n        allow-recursion     { any; };\n        allow-update        { none; };\n        allow-transfer      { any; };\n        notify              explicit;\n\n        masterfile-format   text;\n      };\n\n      logging {\n        channel bind.log {\n          file            \"\/var\/cache\/bind\/bind.log\" versions 10 size 20m;\n          severity        notice;\n          print-category  yes;\n          print-severity  yes;\n          print-time      yes;\n        };\n        category queries  { bind.log; };\n        category default  { bind.log; };\n        category config   { bind.log; };\n      };\n    defer: true\n\n  - path: \/etc\/bind\/named.conf.local\n    owner: root:bind\n    permissions: \"0644\"\n    encoding: text\/plain\n    content: |\n      zone \"nutanix.lab\" IN {\n        type  master;\n        file  \"nutanix.lab.conf\";\n      };\n\n      zone \"8.1.10.in-addr.arpa\" IN {\n        type  master;\n        file  \"10.1.8.0.conf\";\n      };\n    defer: true\n\n  - path: \/var\/cache\/bind\/SOA.conf\n    owner: bind:bind\n    permissions: \"0644\"\n    encoding: text\/plain\n    content: |\n      $TTL 86400    ; 24h\n\n      @ IN SOA      ns1.nutanix.lab. admin.nutanix.lab. (\n        2023072421  ; serial\n        3600        ;  1h refresh\n        600         ; 10m retry\n        432000      ;  5d expire\n        86400       ; 24h default TTL\n      )\n\n      @ NS  ns1.nutanix.lab.\n      @ NS  ns2.nutanix.lab.\n    defer: true\n\n  - path: \/var\/cache\/bind\/nutanix.lab.conf\n    owner: bind:bind\n    permissions: \"0644\"\n    encoding: text\/plain\n    content: |\n      $INCLUDE SOA.conf\n\n      ns1             A   10.1.8.11\n      ns2             A   10.1.8.12\n\n      time            A   10.1.8.201\n\n      admin           A   10.1.8.13\n      foundation      A   10.1.8.14\n      move            A   10.1.8.15\n      xray            A   10.1.8.16\n\n      ntnx-ipmi11     A   10.1.8.101\n      ntnx-ipmi12     A   10.1.8.102\n      ntnx-ipmi13     A   10.1.8.103\n      ntnx-ipmi14     A   10.1.8.104\n\n      ntnx-ahv11      A   10.1.8.111\n      ntnx-ahv12      A   10.1.8.112\n      ntnx-ahv13      A   10.1.8.113\n      ntnx-ahv14      A   10.1.8.114\n\n      ntnx-cvm11      A   10.1.8.121\n      ntnx-cvm12      A   10.1.8.122\n      ntnx-cvm13      A   10.1.8.123\n      ntnx-cvm14      A   10.1.8.124\n\n      ntnx-cluster1   A   10.1.8.100\n                      A   10.1.8.121\n                      A   10.1.8.122\n                      A   10.1.8.123\n                      A   10.1.8.124\n\n      ntnx-pc1        A   10.1.8.31\n      ntnx-pc2        A   10.1.8.32\n      ntnx-pc3        A   10.1.8.33\n\n      ntnx-pc         A   10.1.8.30\n                      A   10.1.8.31\n                      A   10.1.8.32\n                      A   10.1.8.33\n\n      NTNX-fs1-1      A   10.1.8.41\n      NTNX-fs1-3      A   10.1.8.42\n      NTNX-fs1-3      A   10.1.8.43\n\n      fs1             A   10.1.8.41\n                      A   10.1.8.42\n                      A   10.1.8.43\n\n      s3              A   10.1.8.51\n                      A   10.1.8.52\n                      A   10.1.8.53\n                      A   10.1.8.54\n\n      *.s3            A   10.1.8.51\n                      A   10.1.8.52\n                      A   10.1.8.53\n                      A   10.1.8.54\n\n      k8s-1           A   10.1.8.61\n\n\n      @                                                               A               10.1.8.10\n      dc1                                                             A               10.1.8.10\n\n      ForestDnsZones                                                  A               10.1.8.10\n      _ldap._tcp.SITE1._sites.ForestDnsZones                          SRV 0 100 389   dc1.nutanix.lab.\n      _ldap._tcp.ForestDnsZones                                       SRV 0 100 389   dc1.nutanix.lab.\n\n      DomainDnsZones                                                  A               10.1.8.10\n      _ldap._tcp.SITE1._sites.DomainDnsZones                          SRV 0 100 389   dc1.nutanix.lab.\n      _ldap._tcp.DomainDnsZones                                       SRV 0 100 389   dc1.nutanix.lab.\n\n      _gc._tcp.SITE1._sites                                           SRV 0 100 3268  dc1.nutanix.lab.\n      _kerberos._tcp.SITE1._sites                                     SRV 0 100 88    dc1.nutanix.lab.\n      _ldap._tcp.SITE1._sites                                         SRV 0 100 389   dc1.nutanix.lab.\n\n      60503e14-9822-4e54-9fed-aea8e7ab6831._msdcs                     CNAME           dc1.nutanix.lab.\n      _kerberos._tcp.SITE1._sites.dc._msdcs                           SRV 0 100 88    dc1.nutanix.lab.\n      _ldap._tcp.SITE1._sites.dc._msdcs                               SRV 0 100 389   dc1.nutanix.lab.\n      _kerberos._tcp.dc._msdcs                                        SRV 0 100 88    dc1.nutanix.lab.\n      _ldap._tcp.dc._msdcs                                            SRV 0 100 389   dc1.nutanix.lab.\n      _ldap._tcp.a9b9b1b7-bf8d-4053-9407-c41024b3c885.domains._msdcs  SRV 0 100 389   dc1.nutanix.lab.\n      gc._msdcs                                                       A               10.1.8.10\n      _ldap._tcp.SITE1._sites.gc._msdcs                               SRV 0 100 3268  dc1.nutanix.lab.\n      _ldap._tcp.gc._msdcs                                            SRV 0 100 3268  dc1.nutanix.lab.\n      _ldap._tcp.pdc._msdcs                                           SRV 0 100 389   dc1.nutanix.lab.\n\n      _gc._tcp                                                        SRV 0 100 3268  dc1.nutanix.lab.\n      _ldap._tcp                                                      SRV 0 100 389   dc1.nutanix.lab.\n      _kerberos._tcp                                                  SRV 0 100 88    dc1.nutanix.lab.\n      _kerberos._udp                                                  SRV 0 100 88    dc1.nutanix.lab.\n      _kpasswd._tcp                                                   SRV 0 100 464   dc1.nutanix.lab.\n      _kpasswd._udp                                                   SRV 0 100 464   dc1.nutanix.lab.\n\n      _vlmcs._tcp                                                     SRV 0 0 1688    dc1.nutanix.lab.\n    defer: true\n\n  - path: \/var\/cache\/bind\/10.1.8.0.conf\n    owner: bind:bind\n    permissions: \"0644\"\n    encoding: text\/plain\n    content: |\n      $INCLUDE SOA.conf\n\n      10  PTR dc1.nutanix.lab.\n      11  PTR ns1.nutanix.lab.\n      12  PTR ns2.nutanix.lab.\n      13  PTR admin.nutanix.lab.\n      14  PTR foundation.nutanix.lab.\n      15  PTR move.nutanix.lab.\n      16  PTR xray.nutanix.lab.\n\n      101  PTR ntnx-ipmi11.nutanix.lab.\n      102  PTR ntnx-ipmi12.nutanix.lab.\n      103  PTR ntnx-ipmi13.nutanix.lab.\n      104  PTR ntnx-ipmi14.nutanix.lab.\n\n      111  PTR ntnx-ahv11.nutanix.lab.\n      112  PTR ntnx-ahv12.nutanix.lab.\n      113  PTR ntnx-ahv13.nutanix.lab.\n      114  PTR ntnx-ahv14.nutanix.lab.\n\n      41  PTR NTNX-fs1-1.nutanix.lab.\n      42  PTR NTNX-fs1-2.nutanix.lab.\n      43  PTR NTNX-fs1-3.nutanix.lab.\n    defer: true\n\npackage_update: true\npackage_upgrade: true\npackages:\n  - ufw\n  - bind9\nruncmd:\n  - hostnamectl set-hostname ns1.nutanix.lab\n  - ufw allow 22\/tcp\n  - ufw allow 53\n  - ufw --force enable\n  - systemctl enable bind9\n  - systemctl start bind9\npower_state:\n    delay: 1\n    timeout: 60\n    mode: reboot\n    message: \"Rebooting machine\"\n    condition: true\n"
    }
}
